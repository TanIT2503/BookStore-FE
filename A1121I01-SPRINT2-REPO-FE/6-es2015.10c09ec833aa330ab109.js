(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"4d7y":function(t,o,e){"use strict";e.r(o);var n=e("ofXK"),c=e("tyNb"),i=e("4Do0"),r=e("fXoL"),a=e("3q9T"),b=e("e/T/"),s=e("tk/3");let d=(()=>{class t{constructor(t){this.httpClient=t,this.API_URL="http://localhost:8080/api/customer"}findCustomerByAccountId(t){return this.httpClient.get(this.API_URL+"/getCustomerByAccount?accountId="+t)}}return t.\u0275fac=function(o){return new(o||t)(r.bc(s.b))},t.\u0275prov=r.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var l=e("oQGl");function u(t,o){if(1&t&&(r.Xb(0,"p",54),r.xc(1),r.Wb()),2&t){const t=r.jc().$implicit;r.Hb(1),r.zc("",t.bookId.bookPrice," \u0111")}}function h(t,o){if(1&t&&(r.Xb(0,"p",54),r.xc(1),r.Wb()),2&t){const t=r.jc().$implicit;r.Hb(1),r.zc("",t.bookId.bookPrice-t.bookId.bookPrice*t.bookId.bookPromotionId.promotion_percent/100," \u0111")}}function m(t,o){if(1&t){const t=r.Yb();r.Xb(0,"button",57),r.fc("click",(function(){r.sc(t);const o=r.jc().$implicit;return r.jc().subBook(o)})),r.Sb(1,"i",58),r.Wb()}}function p(t,o){if(1&t){const t=r.Yb();r.Xb(0,"button",59),r.fc("click",(function(){r.sc(t);const o=r.jc().$implicit;return r.jc().showInfoCartDelete(o)})),r.Sb(1,"i",58),r.Wb()}}const f=function(t){return["/book/detail",t]};function g(t,o){if(1&t){const t=r.Yb();r.Xb(0,"tr"),r.Xb(1,"th",38),r.Xb(2,"div",39),r.Xb(3,"div",9),r.Xb(4,"input",40),r.fc("change",(function(){r.sc(t);const e=o.index;return r.jc().isChecked(e)})),r.Wb(),r.Wb(),r.Xb(5,"div",41),r.Xb(6,"div"),r.Sb(7,"img",42),r.Wb(),r.Xb(8,"div",43),r.Xb(9,"p",44),r.xc(10),r.Wb(),r.Xb(11,"p",21),r.xc(12),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Xb(13,"td",45),r.vc(14,u,2,1,"p",46),r.vc(15,h,2,1,"p",46),r.Wb(),r.Xb(16,"td",45),r.Xb(17,"div",47),r.vc(18,m,2,0,"button",48),r.vc(19,p,2,0,"button",49),r.Xb(20,"div",50),r.Xb(21,"input",51),r.fc("change",(function(e){r.sc(t);const n=o.$implicit;return r.jc().getQuantity(e.target,n)})),r.Wb(),r.Wb(),r.Xb(22,"button",52),r.fc("click",(function(){r.sc(t);const e=o.$implicit;return r.jc().addBook(e)})),r.Sb(23,"i",53),r.Wb(),r.Wb(),r.Wb(),r.Xb(24,"td",45),r.Xb(25,"p",54),r.xc(26),r.Wb(),r.Wb(),r.Xb(27,"td",45),r.Xb(28,"button",55),r.fc("click",(function(){r.sc(t);const e=o.$implicit;return r.jc().showInfoCartDelete(e)})),r.Sb(29,"i",56),r.Wb(),r.Wb(),r.Wb()}if(2&t){const t=o.$implicit,e=o.index,n=r.jc();r.Hb(4),r.mc("checked",n.checkList[e]),r.Hb(3),r.mc("src",t.bookId.bookImage,r.tc)("routerLink",r.oc(13,f,t.bookId.bookId)),r.Hb(2),r.mc("routerLink",r.oc(15,f,t.bookId.bookId)),r.Hb(1),r.yc(t.bookId.bookName),r.Hb(2),r.yc(t.bookId.bookAuthorId.authorName),r.Hb(2),r.mc("ngIf",t.bookId.bookPromotionId.promotionId<=1),r.Hb(1),r.mc("ngIf",t.bookId.bookPromotionId.promotionId>1),r.Hb(3),r.mc("ngIf",1!=t.cartId.cartQuantity),r.Hb(1),r.mc("ngIf",1==t.cartId.cartQuantity),r.Hb(2),r.mc("value",t.cartId.cartQuantity),r.Hb(1),r.mc("disabled",t.cartId.cartQuantity>=t.bookId.bookQuantity),r.Hb(4),r.zc("",t.cartId.cartTotalMoney," \u0111")}}const k=[{path:"cart",component:(()=>{class t{constructor(t,o,e,n,c){var i;this.tokenStorageService=t,this.cartService=o,this.customerService=e,this.notification=n,this.headerComponent=c,this.isLoggedIn=!1,this.cartBookList=[],this.checkList=[],this.checkAll=!1,this.money=0,this.totalMoney=0,this.moneyBeforePromotion=0,this.totalMoneyBeforePromotion=0,this.cartDelete={cartId:{},bookId:{}},this.customer={},this.cartPaymentList=[],i={id:"#myPaypalButtons",currency:"USD",value:"100.00",onApprove:t=>{alert("Transaction successfull")}},paypal.Buttons({createOrder:function(t,o){return o.order.create({purchase_units:[{amount:{value:i.value}}]})},onApprove:function(t,o){return o.order.capture().then((function(t){i.onApprove(t)}))}}).render(i.id)}ngOnInit(){this.accountId=this.tokenStorageService.getUser().account.accountId,this.customerService.findCustomerByAccountId(this.accountId).subscribe(t=>{this.customer=t},()=>{},()=>{}),this.findAllCartBook(),this.getTotalMoney(),this.isLoggedIn=!!this.tokenStorageService.getToken(),this.isLoggedIn&&(this.userName=this.tokenStorageService.getUser().account.username,this.roles=this.tokenStorageService.getUser().account.roles[0].roleName,console.log("roles: "+this.roles))}findAllCartBook(){this.cartService.findAllCartBook(this.accountId).subscribe(t=>{this.cartBookList=t;for(let o=0;o<t.length;o++)this.checkList.push(!1)},t=>{404===t.status&&(this.cartErr=t.error)}),console.log("cart: ",this.cartBookList)}subBook(t){t.cartId.cartQuantity=t.cartId.cartQuantity-1,this.cartService.updateQuantityCart(t).subscribe(t=>{},()=>{},()=>{this.findAllCartBook(),this.getTotalMoney()})}addBook(t){t.cartId.cartQuantity=t.cartId.cartQuantity+1,this.cartService.updateQuantityCart(t).subscribe(t=>{},()=>{},()=>{this.findAllCartBook(),this.getTotalMoney()})}isAllChecked(){this.checkAll=!this.checkAll,this.checkList.forEach(this.checkAll?(t,o)=>{this.checkList[o]=!0}:(t,o)=>{this.checkList[o]=!1}),this.getTotalMoney()}isChecked(t){this.checkList[t]=!this.checkList[t],this.getTotalMoney()}getTotalMoney(){this.cartService.findAllCartBook(this.accountId).subscribe(t=>{this.cartBookList=t,this.cartBookList.forEach((t,o)=>{this.checkList[o]&&(this.money+=this.cartBookList[o].bookId.bookPrice*this.cartBookList[o].cartId.cartQuantity-this.cartBookList[o].bookId.bookPrice*this.cartBookList[o].cartId.cartQuantity*(this.cartBookList[o].bookId.bookPromotionId.promotion_percent/100),this.moneyBeforePromotion+=this.cartBookList[o].bookId.bookPrice*this.cartBookList[o].cartId.cartQuantity)}),this.totalMoney=this.money,this.money=0,this.totalMoneyBeforePromotion=this.moneyBeforePromotion,this.moneyBeforePromotion=0,console.log(this.totalMoneyBeforePromotion),console.log(this.totalMoney)})}getQuantity(t,o){o.cartId.cartQuantity=t.value,this.cartService.updateQuantityCart(o).subscribe(t=>{},()=>{},()=>{this.findAllCartBook(),this.getTotalMoney()})}showInfoCartDelete(t){this.cartDelete=t}deleteCart(t){console.log(t),this.cartService.deleteBookCart(t).subscribe(()=>{},()=>{},()=>{this.findAllCartBook(),this.headerComponent.getQuantityCart()})}payment(){this.cartBookList.forEach((t,o)=>{this.checkList[o]?(this.cartPaymentList.push(this.cartBookList[o].cartId),this.cartService.paymentCart(this.cartPaymentList).subscribe(t=>{},()=>{},()=>{this.notification.notify(i.d.SUCCESS,"Success","Product payment successfully!",3e3),window.location.assign("/cart")})):this.notification.notify(i.d.ERROR,"Error","Please select the product to pay!")})}}return t.\u0275fac=function(o){return new(o||t)(r.Rb(a.a),r.Rb(b.a),r.Rb(d),r.Rb(i.c),r.Rb(l.a))},t.\u0275cmp=r.Lb({type:t,selectors:[["app-book-cart"]],decls:87,vars:11,consts:[[1,"h-100","h-custom"],[1,"container","h-100","py-5"],[1,"row","d-flex","justify-content-center","align-items-center","h-100"],[1,"col"],[1,"row"],[1,"col-md-8"],[1,"table-responsive"],[1,"table"],["scope","col",1,"bag__container"],[1,"form-check","mb-3","mb-md-0","check__product"],["type","checkbox","value","","id","loginCheck",1,"form-check-input",3,"checked","change"],["scope","col"],[4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"card","shadow-2-strong","payment__container",2,"border-radius","16px"],[1,"card-body","p-4"],[1,"col-12","col-xl-6"],[1,"form-outline"],[1,"form-label"],[1,"d-flex","justify-content-between",2,"font-weight","500"],[1,"mb-2"],[1,"mb-0"],[1,"my-4"],[1,"d-flex","justify-content-between","mb-4",2,"font-weight","500"],[1,"button__container"],["type","button",1,"button","button__content",3,"click"],[1,"d-flex","justify-content-between"],["id","myPaypalButtons"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title"],["type","button","data-mdb-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"modal-footer"],["type","button","data-mdb-dismiss","modal",1,"button","button__close","button-modal","btn-secondary"],["type","button","data-mdb-dismiss","modal",1,"button","button__content","button-modal","btn-primary",3,"click"],["scope","row"],[1,"product__container"],["type","checkbox","value","",1,"form-check-input",3,"checked","change"],[1,"d-flex","align-items-center","book__content"],["alt","Book",1,"img-fluid","rounded-3",2,"width","120px",3,"src","routerLink"],[1,"flex-column","ms-4","name__text"],[1,"mb-2",3,"routerLink"],[1,"align-middle"],["class","mb-0","style","font-weight: 500;",4,"ngIf"],[1,"d-flex","flex-row"],["class","btn btn-link px-2",3,"click",4,"ngIf"],["class","btn btn-link px-2","data-mdb-toggle","modal","data-mdb-target","#exampleModal",3,"click",4,"ngIf"],[1,"quantity__content"],["min","0","name","quantity","value","2","type","number",1,"form-control","form-control-sm",2,"width","50px",3,"value","change"],[1,"btn","btn-link","px-2",3,"disabled","click"],[1,"fas","fa-plus"],[1,"mb-0",2,"font-weight","500"],["data-mdb-toggle","modal","data-mdb-target","#exampleModal",1,"button","button__remove",3,"click"],[1,"fa-solid","fa-trash"],[1,"btn","btn-link","px-2",3,"click"],[1,"fas","fa-minus"],["data-mdb-toggle","modal","data-mdb-target","#exampleModal",1,"btn","btn-link","px-2",3,"click"]],template:function(t,o){1&t&&(r.Xb(0,"section",0),r.Xb(1,"div",1),r.Xb(2,"div",2),r.Xb(3,"div",3),r.Xb(4,"div",4),r.Xb(5,"div",5),r.Xb(6,"div",6),r.Xb(7,"table",7),r.Xb(8,"thead"),r.Xb(9,"tr"),r.Xb(10,"th",8),r.Xb(11,"div",9),r.Xb(12,"input",10),r.fc("change",(function(){return o.isAllChecked()})),r.Wb(),r.Wb(),r.xc(13," Shopping Bag"),r.Wb(),r.Xb(14,"th",11),r.xc(15,"Unit price"),r.Wb(),r.Xb(16,"th",11),r.xc(17,"Quantity"),r.Wb(),r.Xb(18,"th",11),r.xc(19,"Price"),r.Wb(),r.Xb(20,"th",11),r.xc(21,"Remove"),r.Wb(),r.Wb(),r.Wb(),r.Xb(22,"tbody"),r.vc(23,g,30,17,"tr",12),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Xb(24,"div",13),r.Xb(25,"div",14),r.Xb(26,"div",15),r.Xb(27,"div"),r.Xb(28,"div"),r.Xb(29,"div"),r.Xb(30,"div"),r.Xb(31,"label"),r.xc(32," DELIVERED TO "),r.Wb(),r.Wb(),r.Xb(33,"div",16),r.Xb(34,"div",17),r.Xb(35,"label",18),r.xc(36),r.Wb(),r.Wb(),r.Xb(37,"div",17),r.Xb(38,"label",18),r.xc(39),r.Wb(),r.Wb(),r.Wb(),r.Xb(40,"div",16),r.Xb(41,"div",17),r.Xb(42,"label",18),r.xc(43),r.Wb(),r.Wb(),r.Xb(44,"div",17),r.Xb(45,"label",18),r.xc(46),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Xb(47,"div"),r.Xb(48,"div",19),r.Xb(49,"p",20),r.xc(50,"Subtotal"),r.Wb(),r.Xb(51,"p",20),r.xc(52),r.Wb(),r.Wb(),r.Xb(53,"div",19),r.Xb(54,"p",21),r.xc(55,"Save"),r.Wb(),r.Xb(56,"p",21),r.xc(57),r.Wb(),r.Wb(),r.Sb(58,"hr",22),r.Xb(59,"div",23),r.Xb(60,"p",20),r.xc(61,"Total (tax included)"),r.Wb(),r.Xb(62,"p",20),r.xc(63),r.Wb(),r.Wb(),r.Xb(64,"div",24),r.Xb(65,"button",25),r.fc("click",(function(){return o.payment()})),r.Xb(66,"div",26),r.Xb(67,"span"),r.xc(68,"Checkout : "),r.Wb(),r.Xb(69,"span"),r.xc(70),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Sb(71,"div",27),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Xb(72,"div",28),r.Xb(73,"div",29),r.Xb(74,"div",30),r.Xb(75,"div",31),r.Xb(76,"h5",32),r.xc(77,"Remove book in cart"),r.Wb(),r.Sb(78,"button",33),r.Wb(),r.Xb(79,"div",34),r.xc(80),r.Wb(),r.Xb(81,"div",35),r.Xb(82,"button",36),r.xc(83,"Close"),r.Wb(),r.Xb(84,"button",37),r.fc("click",(function(){return o.deleteCart(o.cartDelete.cartId.cartId)})),r.xc(85,"Remove"),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Sb(86,"ngx-notification")),2&t&&(r.Hb(12),r.mc("checked",o.checkAll),r.Hb(11),r.mc("ngForOf",o.cartBookList),r.Hb(13),r.yc(o.customer.customerName),r.Hb(3),r.yc(o.customer.customerPhone),r.Hb(4),r.yc(o.customer.customerAddress),r.Hb(3),r.yc(o.customer.customerEmail),r.Hb(6),r.zc("",o.totalMoneyBeforePromotion," \u0111"),r.Hb(5),r.zc("",o.totalMoneyBeforePromotion-o.totalMoney," \u0111"),r.Hb(6),r.zc("",o.totalMoney," \u0111"),r.Hb(7),r.zc("\xa0\xa0",o.totalMoney," \u0111"),r.Hb(10),r.zc("Are you sure you want to remove ",o.cartDelete.bookId.bookName," from your shopping cart?"))},directives:[n.j,i.a,c.c,n.k],styles:[".quantity__content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}fieldset[_ngcontent-%COMP%], input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{margin-bottom:0}.input__content[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px;width:100%;background:#e7e4da;border-radius:50px;border:none;height:45px}.input__content[_ngcontent-%COMP%]:focus, .input__content[_ngcontent-%COMP%]:hover{border:none;box-shadow:0 0 21px 0 rgba(190,190,173,.3)}[_ngcontent-%COMP%]::-moz-placeholder{color:#6c757d}[_ngcontent-%COMP%]::placeholder{color:#6c757d}.button-modal[_ngcontent-%COMP%], .button__content[_ngcontent-%COMP%]{border-radius:50px;height:50px}.button-modal[_ngcontent-%COMP%]{width:150px!important}.button__content[_ngcontent-%COMP%]:hover{background:#b28966}.payment__container[_ngcontent-%COMP%]{background:var(--accent-color2)!important;margin-top:40px}.check__product[_ngcontent-%COMP%], .product__container[_ngcontent-%COMP%]{display:flex}.check__product[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-right:20px;margin-left:20px}.bag__container[_ngcontent-%COMP%]{color:#000;display:flex;align-items:center}.ng-star-inserted[_ngcontent-%COMP%]{justify-content:center!important;align-items:center!important}.button__content[_ngcontent-%COMP%]{border-radius:40px;width:100%;height:40px;margin-right:10px;max-width:100%}.button__remove[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;border-radius:6px;width:50px;height:50px;margin-right:10px;max-width:100%}.button__content[_ngcontent-%COMP%]:hover{background:#b28b6c}.button__close[_ngcontent-%COMP%]{background:var(--accent-color2);border-radius:40px;width:auto;height:40px;margin-right:10px}.modal-content[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;width:100%;pointer-events:auto;background-color:var(--light-color)!important;background-clip:padding-box;border:none!important;border-radius:20px!important;outline:0}.name__text[_ngcontent-%COMP%]{display:inline-block;max-width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}button[_ngcontent-%COMP%]:disabled, button[disabled][_ngcontent-%COMP%]{background:#c9c9c9!important;color:#fff;cursor:pointer;pointer-events:none}.modal-title[_ngcontent-%COMP%]{font:inherit}"]}),t})()}];let y=(()=>{class t{}return t.\u0275mod=r.Pb({type:t}),t.\u0275inj=r.Ob({factory:function(o){return new(o||t)},imports:[[c.e.forChild(k)],c.e]}),t})();e.d(o,"CartModule",(function(){return v}));let v=(()=>{class t{}return t.\u0275mod=r.Pb({type:t}),t.\u0275inj=r.Ob({factory:function(o){return new(o||t)},imports:[[n.b,y]]}),t})()}}]);